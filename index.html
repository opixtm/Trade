<!DOCTYPE html>
<html lang="id" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuesioner Penelitian SDM (Online)</title>
    <style>
        /* --- CSS SETUP (Dark/Light Mode) --- */
        :root {
            --primary: #2c3e50;
            --accent: #3498db;
            --bg: #f4f6f8;
            --card-bg: #ffffff;
            --text: #333333;
            --text-muted: #666666;
            --border: #e0e0e0;
            --input-bg: #ffffff;
            --header-text: #ffffff;
            --shadow: rgba(0,0,0,0.05);
            --desc-bg: #f9f9f9;
        }

        [data-theme="dark"] {
            --primary: #1a252f;
            --accent: #5dade2;
            --bg: #121212;
            --card-bg: #1e1e1e;
            --text: #e0e0e0;
            --text-muted: #a0a0a0;
            --border: #333333;
            --input-bg: #2d2d2d;
            --header-text: #e0e0e0;
            --shadow: rgba(0,0,0,0.5);
            --desc-bg: #2d2d2d;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0; padding: 0; line-height: 1.6;
            transition: background 0.3s, color 0.3s;
        }

        header {
            background: var(--primary); color: var(--header-text);
            padding: 1.5rem 1rem; display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 2px 10px var(--shadow); position: sticky; top: 0; z-index: 100;
        }
        .header-content h1 { margin: 0; font-size: 1.4rem; }
        .theme-toggle {
            background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2);
            color: white; padding: 8px 15px; border-radius: 20px; cursor: pointer;
        }

        .container { max-width: 800px; margin: 20px auto 50px; padding: 0 15px; }

        .card {
            background: var(--card-bg); border-radius: 12px; padding: 25px; margin-bottom: 20px;
            box-shadow: 0 4px 6px var(--shadow); border-left: 5px solid var(--accent);
        }
        .card h2 { margin-top: 0; color: var(--accent); border-bottom: 1px solid var(--border); padding-bottom: 10px; font-size: 1.3rem; }
        .card-desc { font-size: 0.9rem; color: var(--text-muted); background: var(--desc-bg); padding: 10px; border-radius: 6px; margin-bottom: 20px; font-style: italic; }

        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 600; }
        .form-control {
            width: 100%; padding: 12px; background: var(--input-bg); border: 1px solid var(--border);
            color: var(--text); border-radius: 6px; box-sizing: border-box;
        }

        .question-item { margin-bottom: 25px; padding-bottom: 15px; border-bottom: 1px dashed var(--border); }
        .question-text { font-weight: 500; margin-bottom: 15px; display: block; }
        
        .likert-scale { display: flex; justify-content: space-between; background: var(--desc-bg); padding: 10px; border-radius: 8px; }
        .likert-option { display: flex; flex-direction: column; align-items: center; cursor: pointer; flex: 1; }
        .likert-option input { margin-bottom: 5px; cursor: pointer; width: 18px; height: 18px; accent-color: var(--accent); }
        .likert-option span { font-size: 0.7rem; color: var(--text-muted); text-align: center; font-weight: bold; }

        .btn-group { text-align: right; margin-top: 30px; }
        .btn { padding: 12px 30px; border: none; border-radius: 6px; font-size: 1rem; cursor: pointer; font-weight: bold; color: white; width: 100%; }
        .btn-primary { background: var(--accent); }
        .btn-primary:disabled { background: #95a5a6; cursor: wait; }

        #successMessage { display: none; background: #27ae60; color: white; padding: 20px; border-radius: 8px; text-align: center; margin-bottom: 20px; font-weight: bold; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
    </style>
</head>
<body>

<header>
    <div class="header-content">
        <h1>Kuesioner Penelitian SDM</h1>
        <p style="margin:5px 0 0; opacity:0.8; font-size:0.9rem;">Magister Manajemen Sumber Daya Manusia</p>
    </div>
    <button class="theme-toggle" onclick="toggleTheme()">ðŸŒ™ Mode</button>
</header>

<div class="container">
    <div id="successMessage">
        âœ… DATA BERHASIL TERKIRIM!<br>
        <span style="font-size:0.9rem; font-weight:normal;">Terima kasih telah berpartisipasi. Jawaban Anda sudah tersimpan di Server.</span>
    </div>

    <form id="researchForm" name="researchForm">
        
        <div class="card">
            <h2>Data Demografi</h2>
            <div class="form-group">
                <label>Nama / ID Responden</label>
                <input type="text" name="ID" class="form-control" placeholder="Isi nama atau inisial Anda..." required>
            </div>
            <div class="form-group">
                <label>Usia</label>
                <input type="number" name="Usia" class="form-control" placeholder="Contoh: 30" required>
            </div>
            <div class="form-group">
                <label>Jenis Kelamin</label>
                <select name="JK" class="form-control">
                    <option value="L">Laki-laki</option>
                    <option value="P">Perempuan</option>
                </select>
            </div>
        </div>

        <div class="card" style="border-left-color: #f1c40f;">
            <h2 style="color: #f39c12;">Petunjuk</h2>
            <p>Pilihlah angka <strong>1 (Sangat Tidak Setuju)</strong> sampai <strong>5 (Sangat Setuju)</strong>.</p>
        </div>

        <div class="card" id="section-MI">
            <h2>1. Identitas Moral (Moral Identity)</h2>
            <div class="card-desc">Tentang karakteristik: peduli, adil, ramah, jujur, dsb.</div>
        </div>

        <div class="card" id="section-UPB">
            <h2>2. Perilaku Pro-Organisasi (UPB)</h2>
            <div class="card-desc">Tindakan membantu organisasi (walau mungkin melanggar aturan).</div>
        </div>

        <div class="card" id="section-OI">
            <h2>3. Identifikasi Organisasi (OI)</h2>
            <div class="card-desc">Perasaan keanggotaan Anda di organisasi ini.</div>
        </div>

        <div class="card" id="section-TL">
            <h2>4. Kepemimpinan Transformasional (TL)</h2>
            <div class="card-desc">Penilaian terhadap atasan langsung Anda.</div>
        </div>

        <div class="btn-group">
            <button type="submit" class="btn btn-primary" id="btnSubmit">KIRIM JAWABAN</button>
        </div>
    </form>
</div>

<script>
    // --- 1. CONFIG URL GOOGLE SCRIPT KAMU ---
    const scriptURL = 'https://script.google.com/macros/s/AKfycbwsg-RiDXx50MxhBOGcondpgH4GxP5m0GLgaQd_9i48Jc-2UOBMlY3kUm129OWl70FgdQ/exec';

    // --- 2. DATA PERTANYAAN ---
    const questions = {
        MI: [
            "Memiliki karakteristik moral tersebut memberikan kepuasan batin tersendiri bagi saya.",
            "Menjadi pribadi yang memiliki karakteristik tersebut adalah bagian esensial dari jati diri saya.",
            "Kesejahteraan emosional saya sangat bergantung pada apakah saya memiliki karakteristik tersebut.",
            "Memiliki karakteristik tersebut merupakan elemen penting dalam konsep diri saya.",
            "Saya memiliki hasrat yang kuat untuk memiliki karakteristik-karakteristik tersebut."
        ],
        UPB: [
            "Jika membantu organisasi, saya bersedia memanipulasi kebenaran agar organisasi terlihat baik.",
            "Jika membantu organisasi, saya melebih-lebihkan fakta produk/layanan kepada pelanggan.",
            "Jika menguntungkan organisasi, saya menyembunyikan info negatif dari pelanggan.",
            "Jika diminta, saya memberi rekomendasi bagus untuk karyawan inkompeten agar ia pindah.",
            "Jika diminta, saya menahan refund pelanggan yang tertagih lebih.",
            "Jika perlu, saya menutupi informasi publik yang bisa merusak organisasi."
        ],
        OI: [
            "Keberhasilan organisasi ini saya rasakan sebagai keberhasilan saya pribadi.",
            "Kritik terhadap organisasi terasa seperti penghinaan pribadi bagi saya.",
            "Pujian terhadap organisasi terasa seperti pujian untuk diri saya sendiri.",
            "Saya tidak terlalu ambil pusing dengan apa yang dipikirkan orang lain tentang organisasi. (R)",
            "Saya cenderung menggunakan kata 'mereka' daripada 'kita' saat bicara soal organisasi. (R)"
        ],
        TL: [
            "Pimpinan memiliki pemahaman jelas mengenai arah tujuan organisasi.",
            "Pimpinan memberikan gambaran masa depan yang menarik.",
            "Pimpinan mencari peluang baru bagi organisasi.",
            "Pimpinan menginspirasi melalui rencana masa depannya.",
            "Pimpinan mampu membuat orang lain berkomitmen pada visinya.",
            "Pimpinan memberikan teladan yang baik untuk diikuti.",
            "Pimpinan memimpin dengan memberi contoh nyata.",
            "Pimpinan mendorong kolaborasi antar kelompok kerja.",
            "Pimpinan mendorong karyawan menjadi 'team players'.",
            "Pimpinan mengarahkan kelompok bekerja sama demi tujuan yang sama.",
            "Pimpinan membangun semangat tim di antara karyawan."
        ]
    };

    // --- 3. GENERATOR FORMULIR OTOMATIS ---
    function renderQuestions(sectionId, code, items) {
        const container = document.getElementById(sectionId);
        items.forEach((q, index) => {
            const num = index + 1;
            const keyName = code + num; // Contoh: MI1, MI2, dst.
            const html = `
                <div class="question-item">
                    <span class="question-text">${code}${num}. ${q}</span>
                    <div class="likert-scale">
                        <label class="likert-option"><input type="radio" name="${keyName}" value="1" required><span>1<br>STS</span></label>
                        <label class="likert-option"><input type="radio" name="${keyName}" value="2" required><span>2<br>TS</span></label>
                        <label class="likert-option"><input type="radio" name="${keyName}" value="3" required><span>3<br>N</span></label>
                        <label class="likert-option"><input type="radio" name="${keyName}" value="4" required><span>4<br>S</span></label>
                        <label class="likert-option"><input type="radio" name="${keyName}" value="5" required><span>5<br>SS</span></label>
                    </div>
                </div>
            `;
            container.insertAdjacentHTML('beforeend', html);
        });
    }

    // Render ke layar
    renderQuestions('section-MI', 'MI', questions.MI);
    renderQuestions('section-UPB', 'UPB', questions.UPB);
    renderQuestions('section-OI', 'OI', questions.OI);
    renderQuestions('section-TL', 'TL', questions.TL);

    // --- 4. LOGIKA PENGIRIMAN DATA (ANTI SAKIT KEPALA) ---
    const form = document.forms['researchForm'];
    
    form.addEventListener('submit', e => {
        e.preventDefault();
        
        // Ubah tombol jadi loading
        const btn = document.getElementById('btnSubmit');
        const textAsli = btn.innerText;
        btn.disabled = true;
        btn.innerText = "â³ SEDANG MENGIRIM...";

        // Siapkan data
        const formData = new FormData(form);
        formData.append('Timestamp', new Date().toLocaleString()); // Tambah waktu otomatis

        // Kirim ke Google Sheet (Mode no-cors agar tidak error merah)
        fetch(scriptURL, { method: 'POST', body: formData, mode: 'no-cors'})
            .then(response => {
                // Berhasil
                document.getElementById('successMessage').style.display = 'block';
                window.scrollTo(0, 0); // Scroll ke atas
                form.reset(); // Kosongkan form
                
                btn.disabled = false;
                btn.innerText = "KIRIM LAGI (JIKA ADA)";
            })
            .catch(error => {
                // Gagal (Biasanya koneksi putus)
                alert('Gagal mengirim data! Mohon periksa koneksi internet Anda.');
                btn.disabled = false;
                btn.innerText = textAsli;
                console.error('Error!', error.message);
            });
    });

    // --- 5. DARK MODE TOGGLE ---
    function toggleTheme() {
        const html = document.documentElement;
        const current = html.getAttribute('data-theme');
        const next = current === 'light' ? 'dark' : 'light';
        html.setAttribute('data-theme', next);
    }
    // Auto dark mode sesuai sistem HP/Laptop
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        toggleTheme();
    }
</script>

</body>
</html>
